---
title: Learning an Animatable Detailed 3D Face Model from In-The-Wild Images(DECA) ë…¼ë¬¸ ë¦¬ë·°
date: 2023-11-16 00:00:00 +09:00
categories: [Paper, 3D Head Generation]
use_math: true
tags:
  [
    Paper,
    3D Head Generation
  ]
pin: true
---

## Abstract

![Untitled](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/0e422e42-a925-48d3-a05f-dcf26152e855)

- ê¸°ì¡´ monocular 3D face reconstruction methodëŠ” geometric detailsë¥¼ ê½¤ ì˜ ë³µì›í•˜ì§€ë§Œ, ëª‡ëª‡ì˜ í•œê³„ì ì´ ì¡´ì¬í•œë‹¤.
â†’ ëª‡ëª‡ì˜ methodë“¤ì€ expression(í‘œì •)ì— ë”°ë¼ ì£¼ë¦„ì´ ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ modelingí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚¬ì‹¤ì ìœ¼ë¡œ ì›€ì§ì´ì§€ ëª»í•˜ëŠ” faceë¥¼ ìƒì„±í•œë‹¤.
â†’ ë‹¤ë¥¸ methodë“¤ì€ high-quality fcae scansìœ¼ë¡œ í•™ìŠµì´ ë˜ì§€ë§Œ, ì‹¤ì œ imageë“¤ì— ì¼ë°˜í™”ê°€ ì˜ ë˜ì§€ ì•ŠëŠ”ë‹¤.
- ë…¼ë¬¸ì€ ê°œì¸ë§ˆë‹¤ specificí•˜ì§€ë§Œ, í‘œì •ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” 3D face shapeì™€ animatable(ìƒë™ì ì¸) detailì„ regressioní•˜ëŠ” ì²« ì ‘ê·¼ë²•ì„ ì œì‹œí•œë‹¤.
- ë…¼ë¬¸ì˜ ëª¨ë¸ **DECA(Detailed Expression Capture and Animation)**ì€ **person-specific detail parameters**ì™€ **generic expression parameters**ë¡œ êµ¬ì„±ëœ **low-dimensional latent representation**ì„ í†µí•´ robustí•˜ê²Œ **UV displacement map**ì„ ë§Œë“¤ì–´ë‚´ë„ë¡ í•™ìŠµëœë‹¤.
â†’ RegressorëŠ” single imageë¡œë¶€í„° detail, shape, albedo(ë°˜ì‚¬ë„), expression, pose, illumination(ì±„ë„) parameterë“¤ì„ í•™ìŠµí•œë‹¤.

**UV displacement map**: 3D imageë¥¼ 2Dë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤. 3D imageëŠ” ì¢Œí‘œê°€ x, y, zì¸ 3ì°¨ì›ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆì§€ë§Œ, textureëŠ” 2ì°¨ì›(x, y)ë¡œ í‘œí˜„ë˜ê¸° ë•Œë¬¸ì—, ì´ë¥¼ UV mapìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” ê²ƒ

- ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´, ë…¼ë¬¸ì€ ìƒˆë¡œìš´ **detail-consistency loss**ë¥¼ ì†Œê°œí•œë‹¤.
â‡’ expressionì— ì˜í•œ ì£¼ë¦„ìœ¼ë¡œë¶€í„° person-specific detailì„ êµ¬ë³„í•´ì¤€ë‹¤.
- ì´ëŸ¬í•œ êµ¬ë³„ì€ ë°”ë€Œì§€ ì•ŠëŠ” person-specific detailsëŠ” ìœ ì§€í•˜ë©´ì„œ, expression(í‘œì •) parameterë¥¼ ì¡°ì ˆí•˜ì—¬ í˜„ì‹¤ì ì¸ person-specific wrinklesë¥¼ synthesizeí•œë‹¤.
- **DECA**ëŠ” 3D supervisionê³¼ pairedë˜ì§€ ì•Šì€(unlabeled) ì‹¤ì œ imageë“¤ì„ í†µí•´ í•™ìŠµí•˜ê³ , shape reconstructionì—ì„œ SOTAì˜ ì„±ëŠ¥ì„ ê°–ëŠ”ë‹¤.

## 1. Introduction

![Untitled 1](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/aeba26d6-9df4-4d2a-aa0d-c369d1a98c73)

![Untitled 2](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/8554c6bb-766c-42e6-9bca-ac12659faae0)

![Untitled 3](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/118a9df8-62e5-4d2a-a25e-f4114b0bef90)

- single imageë¡œ 3D facial geometryë¥¼ reconstructioní•œ ê¸°ìˆ ì´ ë‚˜ì˜¨ì§€ 20ë…„ì´ ë˜ì—ˆë‹¤. ê·¸ ì´í›„ 3D face reconstruction methodëŠ” ë¹ ë¥´ê²Œ ë°œì „í•˜ì˜€ê³ , 3D avatar creation, video editing ë“±ì˜ ê¸°ìˆ ë“¤ì— ì ìš©ì´ ê°€ëŠ¥í•´ì¡Œë‹¤. ë¬¸ì œë¥¼ ë‹¤ë£¨ê¸° ì‰½ê²Œ ë§Œë“¤ê¸° ìœ„í•´, ê°€ì¥ ë§ì´ ì¡´ì¬í•˜ëŠ” methodëŠ” pre-computed 3D face modelsë¥¼ ì´ìš©í•˜ì—¬, geometry ë˜ëŠ” appearanceì˜ ì´ì „ ì§€ì‹ì„ í¬í•¨í•œë‹¤. ì´ ëª¨ë¸ë“¤ì€ coarse(ê±°ì¹œ) face shapeì„ ë§Œë“¤ì§€ë§Œ, ì‚¬ì‹¤ì„±ì— í•„ìˆ˜ì ì´ê³  human emotionë¶„ì„ì— ë„ì›€ì´ ë˜ëŠ” geometric details (ex. expression-dependent wrinkles)ë¥¼ ì¡ì•„ë‚´ì§€ ëª»í•œë‹¤.
- ëª‡ëª‡ì˜ methodë“¤ì€ facial geometryì˜ detailì„ ë³µì›í•˜ì§€ë§Œ, high-quality training scanì´ í•„ìš”í•˜ê±°ë‚˜, occlusionì— ì·¨ì•½í•˜ë‹¤. ì–´ë–¤ ì—°êµ¬ë“¤ë„ expressionì˜ ë³€í™”ì— ë”°ë¥¸ wrinkleë³€í™”ì˜ ë³µì›ì— ëŒ€í•´ì„œëŠ” íƒêµ¬í•˜ì§€ ì•Šì•˜ë‹¤. expression-dependent detailì„ í•™ìŠµí•˜ëŠ” ì´ì „ methodë“¤ì€ ëª¨ë‘ detailed 3D scansë¥¼ training dataë¡œ ì‚¬ìš©í•˜ê³ , ê²°ê³¼ì ìœ¼ë¡œ ì¼ë°˜ì ì¸ imageë“¤ì— generalizationí•˜ì§€ ì•Šê±°ë‚˜, expression-dependent detailsë¥¼ geometryê°€ ì•„ë‹Œ appearance mapì˜ ì¼ë¶€ë¡œ modelingí•˜ì—¬ realistic mesh relightingì„ ë°©ì§€í•œë‹¤.

![Untitled 4](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/da84b57e-a886-48f2-8df1-fcc3a9f3250f)

- ë…¼ë¬¸ì€ **DECA(Detailed Expression Capture and Animation)**ì„ ì†Œê°œí•œë‹¤.
â‡’ 2D-to-3D supervisionì—†ëŠ” in-the-wild(ì¼ë°˜ì ì¸) imageë¡œë¶€í„° animatable displacement modelì„ í•™ìŠµí•œë‹¤.
- ì´ì „ ì—°êµ¬ë“¤ê³¼ ëŒ€ì¡°ì ìœ¼ë¡œ, ì´ animatable expression-dependent wrinklesëŠ” ê° ê°œì¸ì— íŠ¹í™”ë˜ì–´ ìˆê³ , í•˜ë‚˜ì˜ imageë¡œë¶€í„° regressionëœë‹¤.
- êµ¬ì²´ì ìœ¼ë¡œ DECAëŠ”
1) subject-specific detail parameterì™€ expression parameterë“¤ë¡œ êµ¬ì„±ëœ **low-dimensional representation**ì„ í†µí•´ UV displacement mapì„ ë§Œë“œëŠ” **Geometric detail model**
2) subject-specific detail, albedo, shape, expression, pose, lighting ë“±ì˜ parameterë¥¼ imageë¡œë¶€í„° ì˜ˆì¸¡í•˜ëŠ” **Regressor**
ë¥¼ ê°™ì´ í•™ìŠµí•œë‹¤. 

â‡’ **detail model**ì€ FLAMEëª¨ë¸ì˜ coarse geometryë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤.
â‡’ ë…¼ë¬¸ì€ displacement(ë³€ìœ„)ë¥¼ subject-specific detail parameterì™€ FLAMEì˜ jaw(í„±) poseì™€ expression parameterì˜ í•¨ìˆ˜ë¡œ í‘œí˜„í•œë‹¤.

![Untitled 5](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/53436897-6893-4ba3-aaf1-6cce671d2d70)

- ì´ ê²ƒì€ single imageë¡œë¶€í„° ì‰½ê²Œ avatar creationê³¼ ê°™ì€ ì¤‘ìš”í•œ ë¶„ì•¼ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.
- ì´ì „ì˜ methodë“¤ì´ imageì—ì„œ detailed geometryë¥¼ captureí•  ìˆ˜ ìˆì—ˆì§€ë§Œ, ëŒ€ë¶€ë¶„ì˜ ë¶„ì•¼ë“¤ì€ ìƒë™ê°ìˆëŠ”(animated) faceë¥¼ í•„ìš”ë¡œ í•œë‹¤.
â†’input imageì—ì„œ ì •í™•í•œ geometryë¥¼ ë³µì›í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œëŠ” ì¶©ë¶„í•˜ì§€ ì•Šë‹¤.
- ë…¼ë¬¸ì€ detailed geometryë¥¼ animateí•˜ê²Œ í•  ìˆ˜ ìˆì–´ì•¼ í•˜ê³ , íŠ¹íˆ detailë“¤ì´ person specificí•´ì•¼ í•œë‹¤ê³  ì£¼ì¥.

![Untitled 6](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/da1ee092-2a97-4cbc-bae3-784468adb7c9)

- person-specific details(ex mole(ì ), pore(ëª¨ê³µ), eyebrow, expression-dependent wrinkles)ì„ ìœ ì§€í•˜ë©´ì„œ, reconstructed faceì—ì„œ expression-dependent wrinkles í†µì œëŠ¥ë ¥ì„ ì–»ê¸° ìœ„í•´ì„œëŠ”, **person-specific details**ì™€ **expression-dependent wrinkles**ê°€ ë°˜ë“œì‹œ êµ¬ë³„(disentangled)ë˜ì–´ì•¼ í•œë‹¤.
- ë…¼ë¬¸ì˜ ì£¼ìš” ê¸°ì—¬ëŠ” ìƒˆë¡œìš´ **detail consistency loss**ì´ë‹¤.
â†’disentanglementë¥¼ ê°•ì œí•œë‹¤.
- trainingì‹œì—, ì„œë¡œ ë‹¤ë¥¸ expressionì„ ê°–ëŠ” ê°™ì€ ì‚¬ëŒì˜ image 2ì¥ì´ ì£¼ì–´ì§€ë©´, 3D face shapeì™€ person-specific detailsê°€ 2ê°œì˜ imageì—ì„œ ê°™ì§€ë§Œ expressionê³¼ expressionì— ë”°ë¥¸ wrinkle intensityê°€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì„ ë°œê²¬í–ˆë‹¤.
- ë…¼ë¬¸ì€ trainingì—ì„œì˜ ì´ëŸ¬í•œ íŠ¹ì„±ì„ ì´ìš©í•œë‹¤.
â‡’ ê°™ì€ ì‚¬ëŒì˜ ë‹¤ë¥¸ ì‚¬ì§„ ì‚¬ì´ì˜ detail codeë¥¼ ë°”ê¾¼ë‹¤.
â‡’ ìƒˆë¡­ê²Œ ë§Œë“¤ì–´ì§„ ê²°ê³¼ê°€ ì›ë˜ì˜ imageì™€ ìœ ì‚¬í•˜ê²Œ ë³´ì´ë„ë¡ ê°•ì œí•œë‹¤.
- í•œë²ˆì˜ trainingìœ¼ë¡œ, DECAëŠ” single imageë¡œë¶€í„° detailed 3D faceë¥¼ real timeì— reconstructí•˜ê³ (Fig1, 3ë²ˆì§¸ ì¤„), realistic adaptive expression wrinkleì´ ìˆëŠ” reconstructionì„ animateí•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤(Fig1, 5ë²ˆì§¸ ì¤„).

### Fig 1.

![Untitled 7](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/aca958f1-3ac8-4741-84b2-8216c09fbb69)

[Fig1ì— ëŒ€í•œ ì„¤ëª…]

1ë²ˆì§¸ ì¤„: Sample image

2ë²ˆì§¸ ì¤„: Coarse shape Regression

3ë²ˆì§¸ ì¤„: Detail shape

4ë²ˆì§¸ ì¤„: Coarse shape reposing

5ë²ˆì§¸ ì¤„: Reposing with person-specific details

6ë²ˆì§¸ ì¤„: Source expressionì€ DECAì— ì˜í•´ ì¶”ì¶œë˜ì–´ í‘œí˜„ë˜ëŠ” ê²ƒ

ì¦‰, DECAë¥¼ í†µí•´ Reposingì„ ì§„í–‰í•˜ëŠ” ê²ƒì´ë‹¤.

![Untitled 8](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/9f495df8-cf1f-4932-b299-0e3d9f7f7569)

- ìš”ì•½í•˜ìë©´, ë…¼ë¬¸ì˜ ì£¼ìš” ê¸°ì—¬ë„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

1) ì¼ë°˜ imagesë¥¼ í†µí•´ **animatable displacement model**ì„ í•™ìŠµí•˜ëŠ” ì²« ì ‘ê·¼ë²•
â†’expression parameterë“¤ì„ ë³€í™”ì‹œí‚´ìœ¼ë¡œì¨ ê·¸ëŸ´ë“¯í•œ geometric detailsë¥¼ synthesizeí•œë‹¤.

2) ìƒˆë¡œìš´ **detail cosistency loss**

â†’ identity-dependent, expression-dependentí•œ facial detailsë¥¼ êµ¬ë³„í•œë‹¤.

3) ê¸°ì¡´ ê¸°ë²•ë“¤ê³¼ëŠ” ë‹¤ë¥´ê²Œ **geometric detailsë¥¼ Reconstruction**

â†’ Occlusion, wide pose variation, ilumination variationì— ê°•ì¸í•˜ë‹¤.

â†’ ì´ëŠ”, ë…¼ë¬¸ì˜ **low-dimensional detail representation, detail dientanglement, ì¼ë°˜ imagesì˜ large datasetì„ ì´ìš©í•œ training**ì„ í†µí•´ ê°€ëŠ¥í•  ìˆ˜ ìˆë‹¤.

4) 2ê°œì˜ benchmarkì—ì„œ SOTAë‹¬ì„±

5) ì½”ë“œì™€ ëª¨ë¸ì„ ì—°êµ¬ëª©ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

## 2. Related Work

![Untitled 9](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/de5ec967-913a-4bcf-a0c7-b1e00d060805)

- visual inputìœ¼ë¡œë¶€í„°ì˜ 3D face reconstructionì€ ì§€ë‚œ 10ë…„ê°„ ìƒë‹¹í•œ ê´€ì‹¬ì„ ë°›ì•„ì™”ë‹¤. (multi-view imageë¡œë¶€í„° 3D face reconstructionì„ í•œ ì²«ë²ˆì§¸ methodê°€ ì†Œê°œëœ ì´í›„ë¡œ)
- ê´€ë ¨ ì—°êµ¬ì˜ í° í‹€ì€ ë‹¤ì–‘í•œ input modality(ex multi-view images, video data, RGB-D data, subject-specific image collection)ë¡œë¶€í„° 3D faceë¥¼ reconstructioní•˜ëŠ” ê²ƒì´ì—ˆì§€ë§Œ, ë…¼ë¬¸ì€ í•˜ë‚˜ì˜ RGB imageë§Œì„ ì‚¬ìš©í•œ ë°©ë²•ì— ì¤‘ì ì„ ë‘ì—ˆë‹¤.

### [Coarse Reconstruction]

![Untitled 10](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/6034d806-30e8-41bb-87e6-0d4ad9c3d4a0)

- ë§ì€ monocular 3D face reconstruction methodëŠ” Vetterì™€ Blanzë¥¼ ë”°ë¥¸ë‹¤.
â†’ analysis-by-synthesis fashionì˜ pre-computed statistical(í†µê³„ì ) modelì˜ coefficientë¥¼ ì˜ˆì¸¡
- ì´ëŸ¬í•œ methodë“¤ì€ optimization-based ë˜ëŠ” learning based methodë¡œ ë¶„ë¥˜ë  ìˆ˜ ìˆë‹¤.
- ìœ„ methodë“¤ì€ statistical face modelì˜ parameterë“¤ì„ ì˜ˆì¸¡í•œë‹¤.
â†’ low-frequency shapeì •ë³´ë¥¼ captureí•˜ëŠ” fixed linear shape spaceì—ì„œ
- ì´ëŠ” ë§¤ìš° smoothí•œ reconstructionì„ í•œë‹¤.

![Untitled 11](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/662b6d75-5e8c-4e5e-83f3-09e1efb2dcb0)

- ëª‡ëª‡ì˜ ì—°êµ¬ë“¤ì€ model-freeí•˜ê³ , ì§ì ‘ì ìœ¼ë¡œ 3D face voxelì´ë‚˜ mesh(ê·¸ë¬¼ë§)ì„ regressioní•˜ê³ , ê²°ê³¼ì ìœ¼ë¡œ model-based methodë“¤ë³´ë‹¤ ë” ë‹¤ì–‘í•˜ê²Œ captureí•  ìˆ˜ ìˆë‹¤.
- í•˜ì§€ë§Œ, í•˜ì§€ë§Œ ì´ì™€ ê°™ì€ methodeë“¤ì€ ì •í™•í•œ 3D supervisionì´ í•„ìš”í•˜ë‹¤.
â†’ optimization-based model fitting ë˜ëŠ” statistical face modelì„ samplingí•¨ìœ¼ë¡œì¨ ìƒì„±ëœ synthetic dataë¡œë¶€í„° ì œê³µëœë‹¤.
- ë”°ë¼ì„œ coarse shape variationë§Œì„ captureí•  ìˆ˜ ìˆë‹¤.

![Untitled 12](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/cf3b681d-ebf1-409a-b26c-dbf0767afdf1)

- high-frequency geometric detailë¥¼ captureí•˜ëŠ” ëŒ€ì‹ , ì–´ë–¤ methodë“¤ì€ figh-fidelity texturesì— ë”°ë¼ coarse facial geometryë¥¼ reconstructí•œë‹¤.
- ì´ shading detailì„ textureì— â€œbakeâ€í•˜ë©´, lighting changesê°€ ì´ detailsì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ëª»í•œë‹¤.
â‡’ realismê³¼ applicationì˜ ë²”ìœ„ì— ì œí•œì´ëœë‹¤.
(**bake**: bakeëŠ” Computer Graphicsì—ì„œ ì„¸ë¶€ ì •ë³´ë¥¼ textureì— renderingí•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸, bakingì€ render mappingì´ë¼ê³ ë„ ë¶€ë¥¸ë‹¤)
- animationê³¼ relightingì´ ê°€ëŠ¥í•˜ë„ë¡, DECAëŠ” ì´ëŸ¬í•œ detailsë¥¼ geometryì˜ ì¼ë¶€ë¡œ captureí•œë‹¤.

#### Detail Reconstruction

![Untitled 13](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/5154aca9-5608-4814-b04f-e991313c59ec)

- ì—°êµ¬ì˜ ë‹¤ë¥¸ ì£¼ìš”ë¶€ë¶„ì€ â€œmid-frequencyâ€ detailì„ ê°–ëŠ” faceë¥¼ reconstructioní•˜ëŠ” ê²ƒì´ë‹¤.
- ì¼ë°˜ì ì¸ optimization-based methodë“¤ì€ statistical face modelì„ imageì— fití•˜ì—¬ coarse shape estimateë¥¼ íšë“í•œë‹¤.
â†’ shape from shading(SfS) meothdë¥¼ ë”°ë¼, single image ë˜ëŠ” videoë¡œë¶€í„° facial deatilsë¥¼ reconstructí•œë‹¤.
- DECAì™€ ë‹¤ë¥´ê²Œ, ì´ëŸ¬í•œ ë°©ë²•ë“¤ì€ ëŠë¦¬ê³ , occlusionì— ì·¨ì•½í•˜ë©°, coarse model fitting stepì€ facial landmarksê°€ í•„ìš”í•˜ë‹¤.
â†’ ë§ì€ viewing anglesì™€ occlusionì— ëŒ€í•œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê¸° ì‰½ê²Œ ë§Œë“ ë‹¤.

![Untitled 14](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/e6fe0099-19c3-4d26-b04f-5183b1b4f84a)

- ëŒ€ë¶€ë¶„ì˜ regression-based approachë“¤ì€ coarse shapeë¥¼ ì–»ê¸° ìœ„í•œ statistical face modelì˜ parameterë“¤ì€ reconstructioní•˜ëŠ” ë¹„ìŠ·í•œ ì ‘ê·¼ì„ í•œë‹¤. ê·¸ í›„ localized detailì„ captureí•˜ê¸° ìœ„í•œ **refinement step**ì„ ì§„í–‰
- 'Chen'ê³¼ 'Cao'ëŠ” high resolution scanìœ¼ë¡œë¶€í„° local wrinkle statisticì„ ê³„ì‚°í•˜ê³ , imageë‚˜ videoë¡œë¶€í„° fine-scale detail reconstructionì„ ìœ„í•´ ì‚¬ìš©
- 'Guo'ì™€ 'Richardson'ì€ ì§ì ‘ì ìœ¼ë¡œ per-pixel displacement mapì„ regressioní•œë‹¤.
- ìœ„ ëª¨ë“  methodë“¤ì€ non-occluded region(occlusionì´ ì—†ëŠ”)ì—ì„œ fine-scale detailì„ reconstructioní•œë‹¤.
â‡’ occlusionì´ ìˆëŠ” ê³³ì—ì„œ visible artifacts(noise)ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.
- 'Tran'ì€ face segmentation methodë¥¼ ì ìš©í•˜ì—¬ occluded regionì„ ì•Œì•„ëƒ„ìœ¼ë¡œì¨ occlusionì— ê°•ì¸í•œ ì„±ëŠ¥ì„ ì–»ì—ˆê³ , occluded regionì„ ë‹¤ë£¨ëŠ” ê²ƒì—example-based hole filling approachë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.
- ë” ë‚˜ì•„ê°€, coarse reconstructionì— detailì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ detailed **mesh** ë˜ëŠ” **surface normal(ë²•ì„  ë²¡í„°)**ë¥¼ ì§ì ‘ì ìœ¼ë¡œ reconstructioní•˜ëŠ” model-free methodê°€ ì¡´ì¬í•œë‹¤.

---

#### mesh 

ê°ì²´ì˜ ì™¸ê´€ì„ ìƒì„±í•˜ê¸°ìœ„í•´ ì—°ê²°ëœ ë‹¤ê°í˜•(Polygon)ë“¤ì˜ ì§‘í•©

vertex(ì )ê°€ ëª¨ì—¬ Polygon(ë‹¤ê°í˜•)ì´ ë˜ê³ , Polygonì´ ëª¨ì—¬ Meshê°€ ë˜ëŠ” ê²ƒì´ë‹¤.

---

- 'Tran'ê³¼ 'Tewari'ëŠ” statistical face modelì„ jointly learningí•˜ê³ , imageë¡œë¶€í„° 3D faceë¥¼ reconstructioní•œë‹¤.
â‡’ **jointly learning(jointly training)**: ì—¬ëŸ¬ê°œì˜ lossë¥¼ ë”í•˜ì—¬ ì—¬ëŸ¬ taskë¥¼ í•œë²ˆì— í•™ìŠµí•˜ëŠ” ë°©ë²•

â†’ fixed statistical modelë³´ë‹¤ flexibilityë¥¼ ì œê³µí•˜ë©´, ì´ methodë“¤ì€ ë‹¤ë¥¸ detail reconstruction methodë“¤ë³´ë‹¤ í•œì •ëœ geometric detailì„ captureí•œë‹¤.
- 'Lattas'ëŠ” **diffuse normal**ê³¼ **specular normal**ì„ ì¶”ë¡ í•˜ê¸° ìœ„í•´ image translation networksë¥¼ ì‚¬ìš©í•œë‹¤. â‡’ realistic renderingì´ ê°€ëŠ¥
â†’ DECAì™€ ë‹¤ë¥´ê²Œ, detail reconstruction methodë“¤ì€ animatable detailsë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤.

#### Animatable Detail Reconstruction

![Untitled 15](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/aa3d11f5-fc78-42ae-9834-b760302f2ae9)

- ëŒ€ë¶€ë¶„ DECAì™€ ê´€ë ¨ìˆëŠ” ê²ƒì€ animationì´ ì¡´ì¬í•˜ëŠ” detailed face reconstruction methodì´ë‹¤.
- ì¡´ì¬í•˜ëŠ” methodë“¤ì€ wrinkles ë˜ëŠ” ë‚˜ì´ì™€ ì„±ë³„ê³¼ ê°™ì€ íŠ¹ì„±ë“¤, high-quality 3D face meshì˜ pose ë˜ëŠ” expressionì˜ ì—°ê´€ì„±ì„ í•™ìŠµí•œë‹¤.
- 'Fyffe'ëŠ” dynamic video frameìœ¼ë¡œë¶€í„° ê³„ì‚°ëœ optical flow correspondenceë¥¼ static high-resolutionì„ animateí•˜ëŠ” ê²ƒì— ì‚¬ìš©í•œë‹¤.
- ëŒ€ì¡°ì ìœ¼ë¡œ, DECAëŠ” paired 3D training dataì—†ì´ ì¼ë°˜ì ì¸ ì‚¬ì§„ í•˜ë‚˜ë§Œìœ¼ë¡œ animatable detail modelì„ í•™ìŠµí•œë‹¤.
- FaceScapeëª¨ë¸ì€ single imageë¡œë¶€í„° animatable 3D faceë¥¼ ì˜ˆì¸¡í•˜ì§€ë§Œ, occlusionì— ì·¨ì•½í•˜ë‹¤. 
â‡’ ì´ê²ƒì€ 2ê°œì˜ reconstruction processë•Œë¬¸ì´ë‹¤.
1. coarse shape optimization
2. coarse reconstructionì—ì„œ extractëœ texture mapìœ¼ë¡œë¶€í„° displacement mapì„ ì˜ˆì¸¡í•œë‹¤.

![Untitled 16](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/b1bcccc8-aa31-4c6e-8848-3e4657f97e91)

![Untitled 17](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/092a7790-5959-4c95-9b94-fd03b2aefd43)

- 'Chaudhuri'ëŠ” dynamic(expression-dependent) albedo mapì— ë”°ë¼ identityì™€ expressionì„ ë°”ë¡œì¡ëŠ” **blendshapes**ë¥¼ í•™ìŠµí•œë‹¤.
(blendshapesë€ meshì˜ virtexë¥¼ ë³€í˜•ì‹œì¼œ shapeì— ë³€í˜•ì„ ì£¼ëŠ” ê²ƒ)
â†’ ìœ„ ë°©ë²•ì—ì„œëŠ” geometric detailì„ albedo mapì˜ ì¼ë¶€ë¶„ìœ¼ë¡œ modelingí•˜ì—¬, ì´ detailsì˜ ëª…ì•”ì´ ë‹¤ì–‘í•œ ë¹› ë³€í™”ì— ì¡°ì •ë˜ì§€ ëª»í•œë‹¤. ì´ëŠ” unrealistic renderingì„ ìœ ë°œí•œë‹¤.
- ë°˜ë©´ DECAëŠ” detailsë¥¼ geometric displacementsë¡œ modelingí•˜ì˜€ë‹¤.
â†’ ë¹›ì´ ë°”ë€Œì–´ë„ ìì—°ìŠ¤ëŸ½ê²Œ ë³´ì¸ë‹¤.

![Untitled 18](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/0a2214d9-dfc6-44ac-bd7d-d8fe92af4bd1)

- ìš”ì•½í•˜ìë©´, DECAëŠ” ìœ ì¼ë¬´ì´í•˜ë‹¤.
- DECAëŠ” single imageë¥¼ inputìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , í˜„ì‹¤ì„± ìˆê²Œ animateë˜ê²Œ í•´ì£¼ëŠ” **person-specific details**ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.
- ëª‡ëª‡ì˜ methodë“¤ì€ higher-frequency pixel-aligned detailì„ ë§Œë“¤ì§€ë§Œ, animatableí•˜ì§€ ì•Šë‹¤.
- ì—¬ì „íˆ ë‹¤ë¥¸ methodë“¤ì€ high-resolution scanì´ trainingì— í•„ìš”í•˜ë‹¤.
- ë…¼ë¬¸ì€ high-resolution scanì´ í•„ìˆ˜ì ì´ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì£¼ê³ , paired 3D ground truthê°€ ì—†ëŠ” 2D imageë§Œìœ¼ë¡œë„ animatable detailsë¥¼ trainingí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì¤€ë‹¤.
- ì´ê²ƒì€ í¸ë¦¬í•  ë¿ë§Œ ì•„ë‹ˆë¼, DECAê°€ í˜„ì‹¤ ì† ë³€í™”ì˜ ë„“ì€ ë‹¤ì–‘ì„±ì„ robustí•˜ê²Œ í•™ìŠµí•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•œë‹¤.
- DECAì˜ elementsëŠ” ì˜ ì•Œë ¤ì§„ ì›ë¦¬([Vetter and Blanz]ë¶€í„°)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œì§€ë§Œ, ë…¼ë¬¸ì˜ ê¸°ì—¬ë„ëŠ” ìƒˆë¡­ê³  í•„ìˆ˜ì ì´ë¼ëŠ” ê²ƒì„ ê°•ì¡°í•œë‹¤.
â‡’ DECAê°€ ë™ì‘í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì£¼ìš”í•œ ì ì€ **detail consistency loss**ì´ë‹¤.(ì´ì „ì— ì—†ì—ˆë‹¤)

## 3. Preliminaries

![Untitled 19](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/90623a9b-dfe3-49c8-9d9d-2a9908b3abdc)

- **FLAME**ì€ â€˜ë¶„ë¦¬ëœ linear identity shapeê³¼ expression spaceì˜ **linear blend skinning(LBS)**â€™ì™€ neck, jaw, eyeballì„ ì˜ í‘œí˜„í•˜ëŠ” **pose-dependent corrective blendshapes**ë¥¼ ê²°í•©í•œ statistical 3D head modelì´ë‹¤.

---

#### Linear Blend Skinning(LBS)

LBSëŠ” 3ì°¨ì› ë¬¼ì²´ë¥¼ ì»´í“¨í„° ê·¸ë˜í”½ìœ¼ë¡œ í˜•ìƒí™”ì‹œí‚¬ ë•Œì— ì‚¬ëŒì˜ skeleton structure(ë¼ˆ êµ¬ì¡°)ë¡œë¶€í„° Meshë¥¼ ë§Œë“œëŠ” ë°©ë²•ì´ë‹¤. 

ì¥ì : ì—°ì‚°ëŸ‰ì´ ì ê³  ì ë‹¹í•œ meshìƒì„± ê°€ëŠ¥, Translationì´ë‚˜ Rotation, Scalingê³¼ ê°™ì€ Transformationì„ ë°”ë¡œ ì ìš© ê°€ëŠ¥

 ë‹¨ì : ì ‘íˆê±°ë‚˜ ê¼¬ì´ëŠ” ë¶€ë¶„ì— ëŒ€í•œ í‘œí˜„ì´ ë¶€ìì—°ìŠ¤ëŸ¬ì›€

![Untitled 20](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/81c8ef67-8f80-423c-a043-6c2e4d626edc)

- ê° jointì˜ ì˜í–¥ì„ ë°›ëŠ” meshëŠ” ê°ê°ì˜ transformationì— ë”°ë¼ ë™ì‘
- Linear Blend Skinning ì•Œê³ ë¦¬ì¦˜ì´ ì‚¬ìš©ë˜ëŠ” ë¶€ë¶„ì€ 1, 2ë²ˆ jointê°€ ëª¨ë‘ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” meshì´ë‹¤.

![Untitled 21](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/1f7402e3-49c0-495b-9e45-3f78091f8222)

- ê° jointì— rotationì„ ì£¼ì—ˆì„ ë•Œ, 1, 2ë²ˆ joint ëª¨ë‘ ì˜í–¥ì„ ë°›ëŠ” meshì˜ vertexìœ„ì¹˜ë¥¼ ê³„ì‚°í•´ì•¼ í•œë‹¤. (LBS)

![Untitled 22](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/4ffc4ff7-ec27-4894-b252-c7a39049f2cd)

- jointì˜ weight mapì„ í†µí•´ vertexì˜ ìœ„ì¹˜ë¥¼ ê³„ì‚°í•˜ëŠ”ë°, weight mapì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ì¶”í›„ì— ê³µë¶€í•´ë³´ë ¤ê³  í•œë‹¤.

---

- facial identity(**Î²),** pose(**Î¸**)(këŠ” neck, jaw, eyeballì˜ 4ê°œì˜ joint), expression(**Ïˆ**)ì˜ parameterë“¤ì´ ì£¼ì–´ì¡Œì„ ë•Œ, FLAMEì€ n=5023ê°œì˜ vertexë¥¼ ê°–ëŠ” meshë¥¼ ë°˜í™˜í•œë‹¤. ëª¨ë¸ì€ **ì‹(1)**ê³¼ ê°™ì´ ì •ì˜ëœë‹¤.

![Untitled 23](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/a6be9368-17f8-49d9-8490-f384c6cb081e)

![Untitled 24](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/cc4f1f25-665e-4dfd-b654-197cf4097f93)

- **blend skinning function**: W(T, J, Î¸, w)
â‡’ T: vertex rotation parameter
â‡’ J: joint location
â‡’ w: blendweights (linearly smooth)
- JëŠ” identity(**Î²**)ì˜ functionìœ¼ë¡œ ì •ì˜ëœë‹¤.

![Untitled 25](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/3585b3e2-2d71-4717-9a2a-9ebf087a76b2)

![Untitled 26](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/cc94a9e7-d803-44f5-8aa9-33a0a227949f)

- **T**ëŠ” â€œzero poseâ€ë¥¼ ì˜ë¯¸í•œë‹¤.
â†’ **shape blendshapes** $B_s(Î²;S)$, **pose correctives** $B_p(Î¸;P)$, **expression blendshapes** $B_E(Ïˆ;Ïµ)$ë¥¼ í†µí•´ shapeì´ ì¶”ê°€ëœë‹¤. (S, P, Ïµì— ê¸°ë°˜ì„ ë‘ëŠ” í•™ìŠµëœ identity, pose, expression)

![Untitled 27](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/0ae6cc77-1cce-46b8-9858-0274b9c105c2)

- FLAMEì€ appearance modelì´ ì—†ë‹¤.
â‡’ë…¼ë¬¸ì€ **Basel Face Model**ì˜ linear albedo subspaceë¥¼ **FLAME UV layout**ìœ¼ë¡œ ë³€í™˜ì‹œì¼°ë‹¤.
- **appearance model**ì€ **UV albedo map(A(Î±))**ì„ ì¶œë ¥í•œë‹¤.(**Î±ëŠ” albedo parameters)**

![Untitled 28](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/a1ac8226-502e-459a-91bd-e89fcf4797dc)

- in-the-wild face datasetsì— ì¡´ì¬í•˜ëŠ” ì‚¬ì§„ë“¤ì€ ë³´í†µ distanceì˜ ì§ˆì„ ë–¨ì–´ëœ¨ë¦°ë‹¤.
- ë”°ë¼ì„œ ë…¼ë¬¸ì€ **orthographic(ì •ì‚¬ì˜) camera model(c)**ë¥¼ ì‚¬ìš©í•œë‹¤.
â‡’ 3D meshë¥¼ image spaceë¡œ íˆ¬ì˜ì‹œí‚¨ë‹¤.
- Face vertexë“¤ì€ $v = ğ‘ Î (ğ‘€_ğ‘–)+t$ì— ë”°ë¼ imageë¡œ projectëœë‹¤.
$M_i$: Mì— ì¡´ì¬í•˜ëŠ” vertex
$Î $: orthographic(ì •ì‚¬ì˜) 3D-2D projection matrix
$s, t$: isotropic(ë“±ë°©ì„±) scaleê³¼ 2D translationì„ ì˜ë¯¸í•œë‹¤.(s, tëŠ” **c**ë¡œ ìš”ì•½ë¨)

![Untitled 29](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/691df693-1b4f-4063-810c-11bd66336330)

![Untitled 30](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/ca6166b2-9027-4703-be27-fd7539189e42)

- Face reconstructionì—ì„œ ê°€ì¥ ìì£¼ ì‚¬ìš©ë˜ëŠ” **illumination model**ì€ **Spherical Harmonics(SH)** ì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤.
â‡’ illumination model: ê´‘ì›ì— ì˜í•œ pixelì˜ ë°ê¸°ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•
- light source(ê´‘ì›)ì´ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆê³ , faceì˜ surface reflectance(í‘œë©´ ë°˜ì‚¬)ê°€ **Lambertian**ì´ê³  ê°€ì •í•  ë•Œ, shaded face imageëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ëœë‹¤.

---

â‡’ **Lambertian Surface**: ì–´ë–¤ ë°©í–¥ì—ì„œ ë³´ì•„ë„ ë˜‘ê°™ì€ ë°ê¸° ê°’ì„ ë³´ì´ëŠ” í‘œë©´.
ë³´í†µ ì›€ì§ì´ë©° ê°™ì€ ì§€ì ì„ ë°”ë¼ë³¼ ë•Œ, ë°ê¸° ê°’ì´ ë³€í™”í•œë‹¤. í•˜ì§€ë§Œ Lambertian surfaceëŠ” ë°”ë€Œì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ê°€ì •í•œë‹¤. ì¦‰ ëª¨ë“  ë°©í–¥ìœ¼ë¡œ ê°™ì€ ì–‘ì˜ ë¹›ì„ ë°˜ì‚¬í•œë‹¤ê³  ê°€ì •í•˜ëŠ” ê²ƒ.
(A4ìš©ì§€ì™€ ê°™ì´ ê°€ê³µë˜ì§€ ì•Šì€ í‘œë©´ì€ Lambertian surfaceì— ê°€ê¹ë‹¤ê³  ë³¼ ìˆ˜ ìˆì§€ë§Œ, ì°¨ í‘œë©´ê³¼ ê°™ì´ ë§¤ëˆí•œ ê²ƒì€ Lambertian surfaceì™€ ë‹¤ë¥´ë‹¤.

---

![Untitled 31](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/be755c6e-3b44-4334-86e1-370caa299995)

![Untitled 32](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/0686e10b-e570-4598-9d8f-a07d9ee6b7dc)

- **albedo(A)**, **surface normal(N)**, **shaded texture(B)** ëŠ” **UV coordinates**ì— ì¡´ì¬í•˜ê³ , (i,j)ëŠ” UV coordinateì˜ pixelìœ„ì¹˜ë¥¼ ì˜ë¯¸í•œë‹¤. **SH(Spherical Harmonics)ì˜ basisì™€ coefficients**ëŠ” $H_k$ì™€ $l$ë¡œ ì •ì˜ë˜ì–´ ìˆë‹¤. (í‰ë©´ì˜ biasëŠ” (1,0), (0,1)ì´ë‹¤). **âŠ™**ëŠ” **Hadamard product**ë¥¼ ì˜ë¯¸í•œë‹¤.

---

**Hadamard product**

![Untitled 33](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/ceb11fb3-eced-4de8-82ec-d2da40a316f0)

---

![Untitled 34](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/db4db111-f23e-40dd-8059-d43a1baf2964)

- **geometry parameters $(Î²,Î¸, Ïˆ)$, albedo(Î±), lighting($l$), camera information(c)**ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, 2D image($I_r$)ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
â†’ $I_r=R(M, B, c)$ ($R$ì€ rendering function)
- FLAMEì€ low-dimensional latent spaceë¡œë¶€í„° ë‹¤ì–‘í•œ poses, shapes, expressionsë¥¼ ê°–ëŠ” **face geometry**ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
- í•˜ì§€ë§Œ modelì˜ representational powerëŠ” **low mesh resolution**ì— ì˜í•´ ì œí•œë˜ê³ , ê·¸ë¡œ ì¸í•´ mid-frequency detailì´ FLAMEì˜ surfaceì—ì„œ ëŒ€ë¶€ë¶„ ì†Œë©¸ëœë‹¤.
- ë‹¤ìŒ sectionì—ì„œëŠ” ë…¼ë¬¸ì˜ **expression-dependent displacement model**ì„ ì†Œê°œí•œë‹¤.
â‡’mid-frequency detailì´ ìˆëŠ” FLAMEì„ ì…ì¦í•œë‹¤.
- ë˜í•œ, single imageë¡œë¶€í„° geometryë¥¼ ì–´ë–»ê²Œ reconstructí•˜ê³ , animatableí•˜ê²Œ ë§Œë“œëŠ”ì§€ ì¦ëª…í•  ê²ƒì´ë‹¤.

## 4. Method

![Untitled 35](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/78b722ed-969d-4d22-b1e6-81ac6fe753b7)

- DECAëŠ” in-the-wild training imagesì„ ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ geometric detailì´ ì¡´ì¬í•˜ëŠ” parameterized face modelì„ regressioní•˜ë„ë¡ í•™ìŠµëœë‹¤. (Fig2, Left)
- training í›„ì—, DECAëŠ” single face image($I$)ë¡œë¶€í„° detailed face geometryê°€ ìˆëŠ” 3D headë¥¼ reconstructí•  ìˆ˜ ìˆë‹¤.(Fig2, Right)
- reconstructed detailsì˜ í•™ìŠµëœ parameterization(ë§¤ê°œë³€ìˆ˜í™”)ëŠ” detail reconstructionì´ animatableí•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
â†’ FLAMEì˜ expressionê³¼ jaw pose parameterë¥¼ ì¡°ì ˆí•¨ìœ¼ë¡œì¨
- ìœ„ëŠ” person-specific detailì´ ë°”ë€Œì§€ ì•Šë„ë¡ ìœ ì§€í•˜ë©´ì„œ ìƒˆë¡œìš´ wrinklesë¥¼ synthesizeí•  ìˆ˜ ìˆë‹¤.

---

![Untitled 36](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/84385131-a6c9-4cd9-a7c1-f8c7e23f06aa)

[Fig2ì— ëŒ€í•œ ì„¤ëª…]

**Training ì‹œì—(left box)**, 

- DECAëŠ” ê° imageë³„ë¡œ face shape reconstructionì„ ìœ„í•œ parameterë“¤ì„ ì˜ˆì¸¡í•œë‹¤.
â‡’ **shape consistency information**ì˜ ì •ë³´ë¥¼ ì°¸ê³ í•˜ì—¬(íŒŒë€ìƒ‰ í™”ì‚´í‘œ)
- ê·¸ í›„, expression-conditioned displacement modelì„ í•™ìŠµí•œë‹¤.
â‡’ ê°™ì€ individualì˜ ì—¬ëŸ¬ imageë“¤ë¡œë¶€í„° ì–»ì€ **detail consistency information**ì„ í™œìš©í•˜ì—¬(ë¹¨ê°„ìƒ‰ í™”ì‚´í‘œ)
- ì§€ê¸ˆê¹Œì§€ëŠ” analysis-by-synthesis piplineì€ ê¸°ì¡´ê³¼ ê°™ì§€ë§Œ, Fig2 leftì˜ ë…¸ë€ìƒ‰ ë°•ìŠ¤ ë¶€ë¶„ì€ ë…¼ë¬¸ì˜ ìƒˆë¡œìš´ keyì´ë‹¤.
â‡’ ìœ„ displacement consistency lossëŠ” Fig3ì— ë” ìì„¸íˆ ë‚˜ì™€ìˆë‹¤.

**Trainingëœ í›„ì—(right box),**

- DECAëŠ” reconstructed source identityì˜ shape, head pose, detail codeë¥¼ reconstructed source expressionì˜ jaw pose, expression parameterì™€ ê²°í•©í•¨ìœ¼ë¡œì¨ faceë¥¼ animatableí•˜ê²Œ ë§Œë“ ë‹¤.
â‡’ animated coarse shapeê³¼ animated displacement mapì„ ì–»ê¸° ìœ„í•œ ì—°ì‚°
- ìµœì¢…ì ìœ¼ë¡œ DECAëŠ” animated detail shapeì„ ì¶œë ¥í•œë‹¤.

(ìœ„ ì´ë¯¸ì§€ë“¤ì€ NoW Datasetì—ì„œ ê°€ì ¸ì˜¨ ê²ƒì´ì§€ë§Œ, DECAë¥¼ í•™ìŠµì‹œí‚¨ ê²ƒì´ ì•„ë‹ˆë¼ illustrationì˜ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ëœ ê²ƒ)

**ê²°êµ­ ê¸°ì¡´ ë…¼ë¬¸ë“¤ê³¼ ì°¨ë³„ì ì€ displacement mapì„ í†µí•´ detailì„ í•™ìŠµí•˜ëŠ” ë¶€ë¶„ì¸ ê²ƒ ê°™ë‹¤.**

---

![Untitled 37](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/9fa35839-5eb9-40fd-9373-02d3bdac8823)

- **Detail Consistency Loss**: ë…¼ë¬¸ì—ì„œ ê°•ì¡°í•˜ëŠ” ë¶€ë¶„(ìƒˆë¡œìš´ method)
- DECAëŠ” ê°™ì€ ì‚¬ëŒì˜ ì—¬ëŸ¬ imageë“¤ì„ trainingì— ì‚¬ìš©í•œë‹¤.
â‡’ expression-dependent detail(í‘œì •ì— ë”°ë¥¸ detail)ë¡œë¶€í„° static person-specific detailsë¥¼ êµ¬ë³„í•˜ê¸° ìœ„í•´
- ì ì ˆí•˜ê²Œ factoredëœë‹¤ë©´, í•œ ì‚¬ëŒì˜ í•˜ë‚˜ì˜ ì´ë¯¸ì§€ë¡œë¶€í„° detail codeë¥¼ ì–»ì„ ìˆ˜ ìˆê³ , ì´ë¥¼ í†µí•´ different expressionì„ ê°–ëŠ” ê·¸ ì‚¬ëŒì˜ ë‹¤ë¥¸ imageë¥¼ reconstructí•˜ëŠ” ê²ƒì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    
    ---
    

#### Key Idea

![Untitled 38](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/89b1ebfe-1e11-46ff-97fa-b6e5f4866232)

- DECAì˜ **key ideaëŠ” ê° individualì˜ faceê°€ ì„œë¡œ ë‹¤ë¥¸ details(i.e. wrinkles)ì„ ë³´ì¸ë‹¤ëŠ” ê²ƒ**ì„ ë°œê²¬í•œ ê²ƒì— ê¸°ë°˜ì„ ë‘”ë‹¤.
â‡’ facial expressionì— ë”°ë¼ detailsê°€ ë‹¬ë¼ì§€ì§€ë§Œ, shapeì˜ ë‹¤ë¥¸ properties(íŠ¹ì§•)ëŠ” ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.
- ë”°ë¼ì„œ, **facial detailsëŠ” static person-specific detailsì™€ dynamic expression dependent details(i.e. wrinkles)ë¡œ êµ¬ë³„**ë˜ì–´ì•¼ í•œë‹¤.

â‡’ **static person-specific detail: expressionì— ë”°ë¼ ë³€í™”í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ê° individualë§ˆë‹¤ ë‹¤ë¥¸, í•˜ì§€ë§Œ ê°™ì€ individualì´ë¼ë©´ í•­ìƒ ê°™ì€ detailì„ ì˜ë¯¸í•˜ëŠ” ê²ƒ**

â‡’ **dynamic expression dependent detail: wrinklesì™€ ê°™ì€ expressionì— ë”°ë¼ ë³€í™”í•˜ëŠ” detail**

- í•˜ì§€ë§Œ static, dynamic facial detailsë¥¼ êµ¬ë³„í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•œ taskê°€ ì•„ë‹ˆë‹¤.
- static facial detailsëŠ” ì‚¬ëŒë§ˆë‹¤ ë‹¤ë¥´ì§€ë§Œ, dynamic expression dependent facial detailsëŠ” ê°™ì€ ì‚¬ëŒì´ë¼ë„ ë§¤ìš° ë‹¤ì–‘í•˜ë‹¤.
- ë”°ë¼ì„œ DECAëŠ” **expression-conditioned detail model**ì„ í•™ìŠµí•œë‹¤.
â‡’ **person-specific detail latent spaceì™€ expression space ë‘˜ ë‹¤ë¡œë¶€í„° facial detailsë¥¼ ì¶”ë¡ **í•˜ê¸° ìœ„í•¨

![Untitled 39](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/85f6baf9-db19-4776-ad1f-308c2e88095d)

- detail displacement modelì„ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì— ê°€ì¥ ê¹Œë‹¤ë¡œìš´ ì ì€ training dataê°€ ë¶€ì¡±í•˜ë‹¤ëŠ” ê²ƒì´ë‹¤.
- ì´ì „ ì—°êµ¬ë“¤ì€ detailed facial geometryë¥¼ íšë“í•˜ê¸° ìœ„í•´, í†µì œëœ í™˜ê²½ì—ì„œ ì „ë¬¸ì ì¸ ì¹´ë©”ë¼ ì‹œìŠ¤í…œìœ¼ë¡œ ì‚¬ëŒì„ scaní•˜ì—¬ ì‚¬ìš©í–ˆë‹¤.
- í•˜ì§€ë§Œ ì´ ë°©ë²•ì€ ë‹¤ì–‘í•œ í‘œì •ê³¼ ì¸ì¢…, ë‚˜ì´ì— ë”°ë¥¸ ë‹¤ì–‘ì„±ì„ ê°–ëŠ” ë§ì€ identityë¥¼ capturingí•˜ëŠ” ê²ƒì— ë¹„ìš©ì´ ë§ì´ ë“¤ê³  ë¹„ì‹¤ìš©ì ì´ë‹¤.
- ë”°ë¼ì„œ ë…¼ë¬¸ì€ in-the-wild imagesë¡œë¶€í„° detail geometryë¥¼ í•™ìŠµí•˜ëŠ” ë°©ë²•ì„ ì œì•ˆí•œë‹¤.

### 4.1 Coarse Reconstruction

![Untitled 40](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/34aad270-ac86-4f89-9acb-36d3d921c963)

![Untitled 41](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/2e9c4111-aeff-4e92-acd3-02993f8e5177)

- ë…¼ë¬¸ì€ ë¨¼ì € **analysis-by-synthesis**ë°©ì‹ìœ¼ë¡œ coarse reconstructionì„ í•™ìŠµí•œë‹¤.
â‡’ 2D image($I)$ì´ inputìœ¼ë¡œ ì£¼ì–´ì§€ë©´, imageë¥¼ latent codeë¡œ encodingí•˜ê³ , 2D image($I_r$)ì„ synthesizeí•˜ê¸° ìœ„í•œ decodingì„ í•œë‹¤.
â‡’ ê·¸ í›„, inputê³¼ synthesized imageì˜ differenceë¥¼ ìµœì†Œí™”í•œë‹¤.
- Fig2ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´, ë…¼ë¬¸ì€ encoder $E_c$ì„ **low-dimensional latent code**ë¥¼ regressioní•  ìˆ˜ ìˆë„ë¡ í•™ìŠµì‹œí‚¨ë‹¤.
â‡’ $E_c$ëŠ” FC layerê°€ ìˆëŠ” ResNet50ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.
- **latent code**ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ëœë‹¤.

â‡’FLAME parameters **Î²(100ê°œì˜ FLAME shape parameters)**, **Ïˆ(50ê°œì˜ expression parameters), Î¸** 

ìœ„ parameterë“¤ì€ **coarse geometry**ë¥¼ ë‚˜íƒ€ëƒ„

â‡’albedo coefficient **Î±(50ê°œì˜ albedo parameters)**

â‡’camera **c**

â‡’ lighting parameters $l$

($E_c$ëŠ” ì´ 236 dimensional latent codeë¥¼ ì˜ˆì¸¡í•œë‹¤.)

![Untitled 42](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/06cecf8e-32e6-49df-ac79-1d17c648b270)

- **subjectë‹¹ multi image**, **corresponding identity labels($c_i$)**, **imageë‹¹ 68ê°œì˜ 2D keypoints($k_i$)** ì™€ í•¨ê»˜ 2D face images($I_i$) datasetì´ ì£¼ì–´ì¡Œì„ ë•Œ, **coarse reconstruction branch**ëŠ” ìœ„ ì‹(4)ë¥¼ minimizeí•˜ë„ë¡ í•™ìŠµëœë‹¤.
**â‡’ $L_{lmk}$: landmark loss
â‡’ $L_{eye}$: eye closure loss
â‡’ $L_{pho}$: photometric loss
â‡’ $L_{id}$: identity loss
â‡’ $L_{sc}$: shape consistency loss
â‡’ $L_{reg}$: regularization**

#### Landmark Re-projection Loss

![Untitled 43](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/ed02a982-16b1-4b89-a059-88ffca464e3a)

---

- **Landmark**: ì–¼êµ´ì—ì„œ ì£¼ìš” ë¶€ë¶„(ëˆˆ, ì½”, í„± ë“±)ì„ ë‚˜íƒ€ë‚´ëŠ” ì¢Œí‘œ, ëŒ€ë¶€ë¶„ 68ê°œì˜ ì¢Œí‘œë¡œ ë‚˜íƒ€ë‚¸ë‹¤.

![Untitled 44](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/389775b2-02bf-4991-ab31-e42b18801f02)

---

- landmark lossëŠ” **ground-truth 2D face landmarks($k_i$)** ì™€ FLAME modelì˜ surfaceìœ„ì˜  **corresponding landmarks($M_i$)(ì˜ˆì¸¡ëœ camera modelì— ì˜í•´ imageë¡œ projectë¨)** ì‚¬ì´ì˜ differenceë¥¼ ì¸¡ì •í•œë‹¤. ì‹(5)ì—ì„œ í•´ë‹¹ Lossë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

#### Eye Closure Loss

![Untitled 45](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/ade61c8c-7c78-4a1d-8623-e090ab825319)

- **Eye closure loss**ëŠ” ëˆˆêº¼í’€ ìœ„ ì•„ë˜ì˜ lendmark $k_i$ì™€ $k_j$ì‚¬ì´ì˜ relative offsetì„ ê³„ì‚°í•œë‹¤.
- ì´í›„ imageë¡œ projectëœ FLAMEì˜ surfaceìœ„ì˜ corresponding landmarks $M_i$ì™€ $M_j$ì‚¬ì´ì˜ relative offsetê³¼ì˜ differenceë¥¼ ì¸¡ì •í•œë‹¤. Lossì˜ ì‹ì€ ìœ„ ì‹(6)ê³¼ ê°™ë‹¤.

![Untitled 46](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/8e3645b7-1813-4cb4-9149-73dbe33e67ca)

- $E$ëŠ” **upper/lower eyelid landmark pairsì˜ set**ì´ë‹¤.
- landmark loss($L_{lmk}$)ëŠ” ì™„ì „í•œ landmark location differencesì— ë¶ˆë¦¬í•˜ë„ë¡ ë™ì‘í•œë‹¤ë©´, Eye closure loss($L_{eye}$)ëŠ” eyelide landmarkì‚¬ì´ì˜ relative differenceì— ëŒ€í•´ ë¶ˆë¦¬í•˜ë„ë¡ ë™ì‘í•œë‹¤.
- eye closure loss($L_{eye}$)ê°€ translation invariantí•˜ê¸° ë•Œë¬¸ì—, projected 3D faceì™€ imageì‚¬ì´ì˜ misalignmentë¥¼ ëœ ì˜ì‹¬í•  ìˆ˜ ìˆë‹¤.($L_{lmk}$ì™€ ë¹„êµí•˜ì—¬)
- ëŒ€ì¡°ì ìœ¼ë¡œ, eye landmarkë¥¼ ìœ„í•œ landmark lossë¥¼ ë‹¨ìˆœí•˜ê²Œ ì¦ê°€ì‹œí‚¤ëŠ” ê²ƒì€ ì „ì²´ì ì¸ face shapeì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆê³ , ë§Œì¡±ìŠ¤ëŸ½ì§€ ëª»í•œ reconstructionìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤.
(Fig 10ì€ eye-closure lossì˜ ì˜í–¥ì„ ë³´ì—¬ì¤€ë‹¤.)

![Untitled 47](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/2f6f839f-6093-47b9-8200-0dfc1e8eb1c0)

â‡’ ìœ„ Fig 10ì„ ë³´ë©´ ë‘ë²ˆì§¸ ì—´ì˜ ê·¸ë¦¼ì´ $L_{eye}$ë¥¼ ì ìš©í•˜ì§€ ì•Šì€ DECAì˜ ê²°ê³¼ì¸ë°, ëˆˆì´ ê°ê¸´ expressionì„ ì¸ì‹í•˜ì§€ ëª»í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

#### Photometric Loss

![Untitled 48](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/f3adf55c-721a-407f-91e6-9d9d27af0933)

- **Photometric Loss**ëŠ” input image($I$)ì™€ rendering image($I_r$)ì‚¬ì´ì˜ errorë¥¼ ê³„ì‚°í•œë‹¤.
ì‹ì€ ìœ„ì™€ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.

![Untitled 49](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/f3e4038a-0342-442e-9a94-2f0a3a5c6cbb)

- $V_I$ëŠ” face skin regionì—ì„œ value 1ê°’, ë‹¤ë¥¸ ê³³ì€ face segmentation methodë¥¼ í†µí•´ íšë“í•œ value 0ê°’ì„ ê°–ëŠ” **face mask**ì´ë‹¤. â€˜âŠ™â€™ëŠ” **Hadamard product**ë¥¼ ì˜ë¯¸í•œë‹¤.
- face regionì—ì„œë§Œ errorë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì€ hair, clothes, sunglasses ë“±ì— ì˜í•´ ë°œìƒí•˜ëŠ” occlusionì— robutstí•˜ê²Œ ë™ì‘í•˜ë„ë¡ í•œë‹¤.
- ë§Œì•½ í•´ë‹¹ **Lossê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, predicted albedoëŠ” occluderì˜ colorë¥¼ ê³ ë ¤**í•˜ê²Œ ëœë‹¤.
â‡’ occluderì˜ ìƒ‰ì€ í”¼ë¶€ìƒ‰ê³¼ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— **unnatural renderingì„ ìœ ë°œ**í•œë‹¤.
(Fig10 ì˜ ë§ˆì§€ë§‰ columnì—ì„œ ë³¼ ìˆ˜ ìˆë‹¤.)

#### Identity Loss

![Untitled 50](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/c95243a4-3489-4cf6-b66b-914dce4b3077)

- ìµœê·¼ì˜ 3D face reconstruction methodë“¤ì€ **identity loss**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ realistic face shapesë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì— íš¨ê³¼ì ì´ë¼ëŠ” ê²ƒì„ ì…ì¦í–ˆë‹¤.
- ì´ì— ë™ê¸°ë¥¼ ë°›ì•„, ë…¼ë¬¸ì€ trainingì‹œì— identity lossë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ **pretrained face recognition network**ë¥¼ ì‚¬ìš©í•œë‹¤.

![Untitled 51](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/8adaf9f5-360a-416f-9243-6efece83d1c7)

- face recognition network($f$)ëŠ” rendered imageì™€ input imageì˜ feature embeddingsë¥¼ ì¶œë ¥í•œë‹¤. ê·¸ í›„ **identity loss**ëŠ” 2ê°œì˜ embeddingì‚¬ì´ì˜ **cosine similarity**ë¥¼ ì¸¡ì •í•œë‹¤.

---

[cosine similarity]

![Untitled 52](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/6fa9f7a0-c53a-4639-a157-ae0b15d8ed48)

---

![Untitled 53](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/6e363982-4dda-4d7d-8bb4-e8dcdd65b54b)

- Identity Loss($L_{id}$)ëŠ” ìœ„ì˜ ì‹(7)ê³¼ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.
- embeddingì‚¬ì´ì˜ errorë¥¼ ê³„ì‚°í•¨ìœ¼ë¡œì¨, lossëŠ” **rendered imageê°€ personâ€™s identityì˜ í•µì‹¬ì ì¸ íŠ¹ì„±ë“¤ì„ captureí•˜ë„ë¡** í•œë‹¤.
â‡’ rendered imageê°€ input subjectì™€ ë˜‘ê°™ì€ ì‚¬ëŒì²˜ëŸ¼ ë³´ì´ë„ë¡ í•´ì¤€ë‹¤.
(Fig 10ì—ì„œ $L_{id}$ë¥¼ í¬í•¨í•œ coarse shapeì˜ ê²°ê³¼ëŠ” input subjectì™€ ë” ìœ ì‚¬í•˜ê²Œ ë³´ì¸ë‹¤.)

#### Shape Consistency Loss

![Untitled 54](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/369e0302-eef0-45da-8ed3-1591c0335ca1)

- ê°™ì€ subject(person)ì˜ $I_i$ì™€ $I_j$ 2ê°œì˜ imageê°€ ì£¼ì–´ì¡Œì„ ë•Œ, **coarse encoder($E_c$)** ëŠ” ê°™ì€ **shape parameters(
$Î²_i$=$Î²_j$)**ë¥¼ ì¶œë ¥í•´ì•¼ í•œë‹¤.
- ì´ì „ ì—°êµ¬ë“¤ì€ $Î²_i$ì™€ $Î²_j$ì˜ distanceê°€ ë‹¤ë¥¸ subjectì— í•´ë‹¹í•˜ëŠ” shape coefficient(ê³ ì •ëœ ê°’)ë³´ë‹¤ ì¡°ê¸ˆ ë” ì‘ê²Œ í•˜ì—¬ **shape consistency**ë¥¼ ìœ ì§€í•˜ë„ë¡ í•˜ì˜€ë‹¤.
- í•˜ì§€ë§Œ, fixed marginì„ ê³ ë¥´ëŠ” ê²ƒì€ ì—¬ì „íˆ challengí•˜ë‹¤.
- ë…¼ë¬¸ì€ $Î²_i$ë¥¼ $Î²_j$ë¡œ ëŒ€ì²´í•˜ëŠ” ìƒˆë¡œìš´ ì „ëµì„ ì œì•ˆí•œë‹¤.(ë‹¤ë¥¸ parameterë“¤ì€ ë³€í•˜ì§€ ì•Šë„ë¡ í•œë‹¤)
- $Î²_i$ì™€ $Î²_j$ê°€ ê°™ì€ subjectë¥¼ ë‚˜íƒ€ë‚¸ë‹¤ê³  í•  ë•Œ, ìœ„ì˜ ìƒˆë¡œìš´ parameter setëŠ” $I_i$ë¥¼ ì˜ reconstructí•  ê²ƒì´ë‹¤. í•´ë‹¹ ê³¼ì •ì€ ì•„ë˜ ì‹(8)ê³¼ ê°™ì´ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.

![Untitled 55](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/60b0a0a2-8bf2-4250-9d88-1aebd13d57c8)

![Untitled 56](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/5c7133d7-73d6-4f56-a45d-55163169cb6f)

- ëª©í‘œëŠ” rendered imageê°€ real personì²˜ëŸ¼ ë³´ì´ë„ë¡ ë§Œë“œëŠ” ê²ƒì´ë‹¤.
- ë§Œì•½ í•´ë‹¹ methodê°€ ê°™ì€ ì‚¬ëŒì¸ 2ê°œ imageì—ì„œ face shapeì´ ì˜¬ë°”ë¥´ê²Œ ì˜ˆì¸¡í•œë‹¤ë©´, ì´ imageë“¤ ì‚¬ì´ì˜ shape parameterë“¤ì„ swappingí•˜ë”ë¼ë„ rendered imageê°€ êµ¬ë³„ë˜ì§€ ì•Šë„ë¡ í•´ì•¼ í•œë‹¤.
- ë”°ë¼ì„œ ë…¼ë¬¸ì€ swapped shape parameterë“¤ë¡œë¶€í„° imageë¥¼ renderingí•  ë•Œ, **photometric loss**ì™€ **identity loss**ë¥¼ ì‚¬ìš©í•œë‹¤.

#### Regularization

![Untitled 57](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/72cf415b-54f2-451e-88e9-81ba3183b135)

### 4.2 Detail Reconstruction

![Untitled 58](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/bc34d1af-dd46-4241-b762-89878a08aa0b)

- **detail reconstruction**ì€ **detailed UV displacement map(D)ë¥¼ í¬í•¨í•œ coarse FLAME geometry**ë¥¼ ì…ì¦í•œë‹¤.
- coarse reconstructionê³¼ ìœ ì‚¬í•˜ê²Œ, ë…¼ë¬¸ì€ encoder $E_d$($E_c$ì™€ ë™ì¼í•œ architecture)ë¥¼ training
â‡’ **$I$ë¥¼ 128-dimensional latent code(Î´)ë¡œ encodingí•˜ë„ë¡(subject-specific detailsê°€ í‘œí˜„ë¨)**
- ê·¸ í›„, latent code(**Î´**)ëŠ” FLAMEì˜ expression(**Ïˆ**), jaw pose parameters($Î¸_{jaw}$)ì™€ concatenateë˜ê³  ($F_d$), $F_d$ëŠ” Dë¡œ decodingëœë‹¤.

#### Detail Decoder

![Untitled 59](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/c2b65bb9-e949-45b6-a14a-dff8a42efa0a)

- **Detail Decoder**ëŠ” ìœ„ ì‹(9)ì™€ ê°™ì´ ì •ì˜ëœë‹¤.
- **detail code(Î´): static person-specific detail(expressionì— ë”°ë¼ ë³€í™”í•˜ì§€ ì•ŠëŠ” detail)ì„ ì¡°ì ˆ**
- coarse reconstruction branchì˜ **expression(Ïˆ), jaw pose parameter($Î¸_{jaw}$)**: **dynamic expression wrinkle detailsë¥¼ capture**
- renderingí•˜ê¸° ìœ„í•´, DëŠ” **normal map**ìœ¼ë¡œ ë³€í™˜ëœë‹¤.
â‡’ normal map: vertex 3ê°œê°€ ëª¨ì˜€ì„ ë•Œ, í‰ë©´ì´ ë§Œë“¤ì–´ì§€ëŠ”ë°, ê·¸ í‰ë©´ì˜ normal vectorê°€ ì¡´ì¬í•œë‹¤. ì¦‰ normal mapì€ meshì˜ normal vectorë“¤ì„ ì˜ë¯¸í•˜ëŠ” ê²ƒ

#### Detail Rendering

![Untitled 60](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/a54d5c4c-b48a-4f19-846e-610e3ed23dde)

- **detail displacement model**ì€ mid-frequency surface detailsë¥¼ ê°–ëŠ” imageë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
- **detailed geometry($M'$)**ì„ reconstructí•˜ê¸° ìœ„í•´ì„œ, ë…¼ë¬¸ì€ $M$ê³¼ $M$ì˜ surface noraml $N$ì„ UV spaceë¡œ ë³€í™˜í•œë‹¤. ($M_{uv}$ê³¼ $N_{uv}$) ê·¸ í›„ Dì™€ combineí•œë‹¤. ì‹(10)ì—ì„œ í•´ë‹¹ ì—°ì‚°ì„ ë³¼ ìˆ˜ ìˆë‹¤.

![Untitled 61](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/59d1fcec-32e3-4ad0-bfbd-36a42bf14f6e)

- $M'$ì„ í†µí•´ noramls $N'$ì„ ê³„ì‚°í•¨ìœ¼ë¡œì¨, normal mapê³¼ í•¨ê»˜ $M$ì„ renderingí•˜ì—¬ **detail rendering $I'_r$**ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. ì‹(11)ê³¼ ê°™ë‹¤.
- detail reconstructionì€ ì‹(12)fmf ìµœì†Œí™”í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ í•™ìŠµëœë‹¤.

![Untitled 62](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/3fa6664b-fdba-42ba-a931-12c7670cdfff)

- **$L_{phoD}$: photometric detail loss**
- **$L_{mrf}$: ID-MRF loss**
- **$L_{sym}$: soft symmetry loss**
- **$L_{regD}$: detail regularization**
- ë…¼ë¬¸ì˜ **estimated albedo**ëŠ” 50 basis vectorë¥¼ ê°–ëŠ” linear modelë¡œ ìƒì„±ë˜ì—ˆê¸° ë•Œë¬¸ì—, renderingëœ coarse face imageëŠ” skin tone, basic facial attributesì™€ ê°™ì€ **low frequency information**ë§Œì„ recoverí•  ìˆ˜ ìˆë‹¤.
- renderingëœ imageì˜ **hight frequency details**ëŠ” ì£¼ë¡œ **displacement map**ì—ì„œ ë„ì¶œëœë‹¤.
â‡’ ë”°ë¼ì„œ, $L_{detail}$ì€ **rendered detailed image**ì™€ **real image**ë¥¼ ë¹„êµí•˜ê¸° ë•Œë¬¸ì—, $F_d$ëŠ” **detailed geometric information**ì„ ê°•ì œì ìœ¼ë¡œ modelingí•˜ê²Œ ëœë‹¤.

#### Detail Photometric Losses

![Untitled 63](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/72f59e82-9ac9-4f8b-a7d8-9d8d8551cfdc)

- ì ìš©ëœ detail displacement mapê³¼ í•¨ê»˜, rendered image $I'_r$ì€ geometric detailsë¥¼ í¬í•¨í•œë‹¤.
- coarse renderingê³¼ ê°™ì´, ë…¼ë¬¸ì€ **photometric loss($L_{phoD}$)** ë¥¼ ì‚¬ìš©í•œë‹¤.
â‡’ì‹ì€ ìœ„ì™€ ê°™ê³ , $V_I$ëŠ” visible skin pixelì˜ mask representingì´ë‹¤.

#### ID-MRF Loss

![Untitled 64](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/593aa9fb-8a7d-419f-abd0-d68299e624ef)

- ë…¼ë¬¸ì€ **geometric details reconstruction**ì„ ìœ„í•´ **Implicit Diversified Markov Random Field(ID-MRF) Loss**ë¥¼ ì‚¬ìš©í•œë‹¤.
- **input image**ì™€ **detail rendering**ì´ ì£¼ì–´ì¡Œì„ ë•Œ, **ID-MRF LossëŠ” pre-trained networkì˜ ì„œë¡œ ë‹¤ë¥¸ layerë“¤ë¡œë¶€í„° feature patchë“¤ì„ extract**í•œë‹¤.
- ê·¸ í›„, **ë‘ ì´ë¯¸ì§€ì˜ corresponding nearest neighbor feature patchesì‚¬ì´ì˜ differenceë¥¼ ìµœì†Œí™”**í•œë‹¤.
- 'Larsen'ê³¼ 'Isola'ëŠ” L1 lossê°€ dataì˜ high frequency informationì„ ë³µì›í•˜ì§€ ëª»í•œë‹¤ëŠ” ê²ƒì„ ì°¾ì•„ëƒˆë‹¤.
â‡’ë”°ë¼ì„œ, ìœ„ 2ê°œì˜ methodëŠ” high-frequency detailì„ ì–»ê¸° ìœ„í•´ discriminatorë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.
- í•˜ì§€ë§Œ, ì´ê²ƒì€ ë¶ˆì•ˆì •í•œ adversarial training processì´ë‹¤.
- ëŒ€ì‹ , **ID-MRF Loss**ëŠ” local patch levelì—ì„œ generated contentë¥¼ original inputìœ¼ë¡œ regularizeí•  ìˆ˜ ìˆë‹¤.â‡’ ì´ê²ƒì´ DECAê°€ high-frequency detailsë¥¼ captureí•  ìˆ˜ ìˆê²Œ í•œë‹¤.

![Untitled 65](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/b0a74af8-2974-429a-b07b-be7671ef32ed)

- 'Wang'ì— ë”°ë¥´ë©´, ID-MRF LossëŠ” VGG19ì˜ conv3_2ì™€ conv4_2 layerì—ì„œ ê³„ì‚°ëœë‹¤.(ì‹(13))
- $L_M(layer_{th})$: VGG19ì˜ $layer_{th}$ layerë¥¼ í†µí•´ $I'_r$ê³¼ $I$ë¡œë¶€í„° extractë˜ëŠ” feature patchì—ì„œ ì‚¬ìš©ë˜ëŠ” **ID-MRF Loss**ë¥¼ ì˜ë¯¸í•œë‹¤.
- photometric lossì—ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ë…¼ë¬¸ì€ $L_{mrf}$ë¥¼ UV spaceì˜ face skin regionì„ ìœ„í•´ì„œë§Œ ê³„ì‚°í•œë‹¤.

#### Soft Symmetry Loss

![Untitled 66](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/baf9ba8d-8f7f-4460-a5aa-87caff319c23)

- self-occlusions(ì•„ë§ˆ ë¨¸ë¦¬ì¹´ë½ê³¼ ê°™ì€ ìš”ì†Œë“¤ì— ì˜í•œ occlusionì„ ì˜ë¯¸í•˜ëŠ” ê²ƒ ê°™ë‹¤.)ì— robustnessë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•´, ë…¼ë¬¸ì€ **non-visible face partsë¥¼ regularizeí•˜ê¸° ìœ„í•œ soft symmetry lossë¥¼ ì¶”ê°€**í•˜ì˜€ë‹¤.(ì‹(14)ë¥¼ minimizeí•˜ë„ë¡ í•™ìŠµ)
- **$V_{uv}$: UV spaceì˜ face skin mask**
- **$flip$: horizontal flip operation**
- ê·¹ë‹¨ì ì¸ ê²½ìš°, $L_{sym}$ì´ ì—†ìœ¼ë©´, boundary artifcats(ê²½ê³„ ë¶€ë¶„ì˜ noise)ê°€ occluded regionì— ë³´ì¸ë‹¤.( Fig 9ì˜ ê°€ì¥ ì•„ë˜ ê·¸ë¦¼)

![Untitled 67](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/ab9941d2-c902-49de-82a8-2449dc317c79)

#### Detail Regularization

![Untitled 68](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/23acaa0e-c357-4cb5-92a4-ae4bf597bd91)

- Detial regularizationì„ í†µí•´ noiseë¥¼ ì¤„ì—¬ì¤€ë‹¤.

### 4.3 Detail Disentanglement

![Untitled 69](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/9937a410-3159-40aa-84b0-81afcda410f6)

- **$L_{detail}$ì„ optimizationí•˜ëŠ” ê²ƒì€ mid-frequency detailì„ ê°–ëŠ” face reconstructionì´ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.**
- í•˜ì§€ë§Œ, ìœ„ Detail reconstructionì„ animatableí•˜ê²Œ ë§Œë“œëŠ” ê²ƒì€ **person specific details(i.g. moles, pores, eyebrows, expression-independent wrinkles)** ë¥¼ êµ¬ë³„í•˜ëŠ” ê²ƒì´ í•„ìš”
â‡’ **person specific detailsëŠ” expression-dependent wrinklesì˜ Î´ì— ì˜í•´ ì œì–´ë˜ê³ , expression-dependent wrinklesëŠ” FLAMEì˜ expression, jaw parameters($Ïˆ, Î¸_{jaw}$)ì— ì˜í•´ ì œì–´ëœë‹¤.**
- ë…¼ë¬¸ì˜ key observationì€ ê°™ì€ **ì‚¬ëŒì˜ 2ê°œì˜ imageëŠ” ìœ ì‚¬í•œ coarse geometryì™€ personalized detailsë¥¼ ê°–ê³  ìˆë‹¤**ëŠ” ê²ƒì´ë‹¤.

![Untitled 70](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/e660bad2-457e-479b-80d6-43b80c16b9fc)

- êµ¬ì²´ì ìœ¼ë¡œ, **detail imageë¥¼ renderingí•˜ê¸° ìœ„í•´ì„œëŠ”, ê°™ì€ subject(person)ì˜ 2ê°œì˜ imageì‚¬ì´ì˜ detail codeë¥¼ êµí™˜í•˜ëŠ” ê²ƒì€ rendered imageì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤.**(ì´ëŠ” Fig3ì— ë‚˜ì™€ìˆë‹¤.)
- ë…¼ë¬¸ì€ image(i)ì˜ jaw, expression parameters ì–»ê³ , image(j)ë¡œë¶€í„° detail codeë¥¼ extractí•˜ê³ , wrinkle detailì„ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ ì´ë¥¼ combineí•œë‹¤.
- ê°™ì€ ì‚¬ëŒì˜ ì„œë¡œ ë‹¤ë¥¸ ì´ë¯¸ì§€ë¼ë¦¬ detail codesë¥¼ swapí•˜ë©´, ìƒì„±ëœ ê²°ê³¼ëŠ” realisticí•  ê²ƒì´ë‹¤.

#### Detail Consistency Loss

![Untitled 71](https://github.com/gihuni99/gihuni99.github.io/assets/90080065/aa769e10-edae-44a6-8bce-7db504984471)

- ê°™ì€ subjectì˜ 2ê°œì˜ image $I_i$ì™€ $I_j$ê°€ ì£¼ì–´ì§ˆ ë•Œ, LossëŠ” ì‹(15)ì™€ ê°™ì´ ì •ì˜ëœë‹¤.
- ìœ„ ì‹ì—ì„œ iê°€ ë“¤ì–´ê°„ parameterë“¤ì€ image $I_i$ì˜ parameterë“¤ì´ê³ , $Î´_j$ëŠ” image $I_j$ì˜ detail codeì´ë‹¤.
- **detail consistency lossëŠ” identity-dependent detailsì™€ expression-dependent detailsë¥¼ êµ¬ë³„í•˜ê¸° ìœ„í•´ì„œ í•„ìˆ˜ì **ì´ë‹¤.
- detail consistency lossê°€ ì—†ì´, person-specific detail code(**Î´**)ê°€ identity, expression dependent detailsë¥¼ captureí•˜ë¯€ë¡œ, reconstructed detailsëŠ” FLAME jaw poseì™€ expressionì„ ë³€í™”í•˜ì—¬ re-poseë  ìˆ˜ ì—†ë‹¤.
    - ë…¼ë¬¸ì€ $L_{dc}$ì˜ í•„ìš”, íš¨ê³¼ì„±ì„ section 6.3ì— ë§í•œë‹¤.